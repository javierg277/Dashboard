{"type":"operationStart","subtype":"profile","data":{"_id":"orS8mvIL2snEJQM7","timestamp":"2024-01-22T09:09:25.841Z","state":"queued","mode":"standard","creationDate":"2024-01-22T09:09:25.849Z","modificationDate":"2024-01-22T09:09:25.849Z","shortid":"3aUx1aA","$entitySet":"profiles"},"doDiffs":false,"timestamp":1705914565842,"id":"bjjw1hfl1w0vc2a","previousOperationId":null,"operationId":"gwhkdgz7vl5emno"}
{"type":"log","level":"info","message":"Render request 17 queued for execution and waiting for available worker","previousOperationId":"gwhkdgz7vl5emno","timestamp":1705914565843,"id":"gfxoak5v6z1xa4y"}
{"type":"operationStart","subtype":"render","name":"sales-main","previousOperationId":"gwhkdgz7vl5emno","timestamp":1705914565870,"id":"b5ihcy1vzd7iyug","previousEventId":"bjjw1hfl1w0vc2a","operationId":"nrqak4lsc2d7gbm"}
{"type":"log","timestamp":1705914565871,"level":"info","message":"Starting rendering request 17","meta":{"rootId":"r8ypkydjvonxqkw","id":"r8ypkydjvonxqkw"},"id":"1tjyqupla7254ui","previousOperationId":"nrqak4lsc2d7gbm"}
{"type":"log","timestamp":1705914565871,"level":"info","message":"Rendering template { name: sales-main, recipe: html-to-xlsx, engine: handlebars, preview: true }","meta":{"rootId":"r8ypkydjvonxqkw","id":"r8ypkydjvonxqkw"},"id":"muliwrg9vunxo8q","previousOperationId":"nrqak4lsc2d7gbm"}
{"type":"log","timestamp":1705914565873,"level":"debug","message":"Inline data specified.","meta":{"rootId":"r8ypkydjvonxqkw","id":"r8ypkydjvonxqkw"},"id":"k4m0eau6gt15u9m","previousOperationId":"nrqak4lsc2d7gbm"}
{"type":"log","timestamp":1705914565877,"level":"debug","message":"Base url not specified, skipping its injection.","meta":{"rootId":"r8ypkydjvonxqkw","id":"r8ypkydjvonxqkw"},"id":"r48ze88ng1xrrhm","previousOperationId":"nrqak4lsc2d7gbm"}
{"type":"operationStart","subtype":"engine","name":"handlebars","timestamp":1705914565878,"id":"1t8hwymh0hjm5mf","previousEventId":"b5ihcy1vzd7iyug","operationId":"z0ul35jb0ru4iue","previousOperationId":"nrqak4lsc2d7gbm"}
{"type":"log","timestamp":1705914565878,"level":"debug","message":"Rendering engine handlebars","meta":{"rootId":"r8ypkydjvonxqkw","id":"r8ypkydjvonxqkw"},"id":"ziaa4koxupolu7y","previousOperationId":"z0ul35jb0ru4iue"}
{"type":"log","timestamp":1705914565978,"level":"warn","message":"Error when processing render request 17\n(because) error when evaluating engine handlebars for template /samples/Sales/sales-main\n(because) require of \"moment\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"moment\"] }\n\n(sandbox.js line 1:165)\n\n> 1 | const moment = require('moment')\n    |                                 ^\n  2 | const rowOffset = 6\n  3 |\n  4 | function nowStr () {\n\n\nError: require of \"moment\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"moment\"] }\n  at sandboxRequire (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\requireSandbox.js:53:19)\n  at Object.require (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:89:30)\n  at eval (sandbox.js:1:165)\n  at async run (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:132:18)\n  at async WorkerReporter.runInSandbox [as _runInSandbox] (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:195:14)\n  at async executeEngine (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:287:14)\n  at async engine.engine (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:115:14)\n  at async invokeRender (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:61:23)\n  at async WorkerReporter._render (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:142:7)\n  at async C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\reporter.js:224:19\n  at async processAndResponse (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\advanced-workers\\lib\\workerHandler.js:41:17)\nwrapped by:\nError: Error when evaluating engine handlebars for template /samples/Sales/sales-main\n(because) require of \"moment\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"moment\"] }\n  at module.exports (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\createError.js:10:13)\n  at WorkerReporter.createError (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\reporter.js:49:12)\n  at executeEngine (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:310:33)\n  at async engine.engine (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:115:14)\n  at async invokeRender (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:61:23)\n  at async WorkerReporter._render (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:142:7)\n  at async C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\reporter.js:224:19\n  at async processAndResponse (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\advanced-workers\\lib\\workerHandler.js:41:17)","meta":{"rootId":"r8ypkydjvonxqkw","id":"r8ypkydjvonxqkw"},"id":"jwf6txdv11y0duo","previousOperationId":"z0ul35jb0ru4iue"}
{"type":"log","timestamp":1705914565978,"level":"warn","message":"Rendering request 17 finished with error in 137 ms","meta":{"rootId":"r8ypkydjvonxqkw","id":"r8ypkydjvonxqkw"},"id":"qzqyuygwvor2p55","previousOperationId":"z0ul35jb0ru4iue"}
{"type":"error","timestamp":1705914565988,"entity":{"shortid":"B1Q2SFTNr","name":"sales-main","content":"<!--\r\nExample for html-to-xlsx conversion\r\nNote: This example requires jsreport to be configured with\r\n{ \"trustUserCode\": true } or\r\n{ \"sandbox\": { \"allowedModules\": [\"moment\"] } }\r\n!-->\r\n<html>\r\n    <head>\r\n        <style>\r\n            {{asset \"sales-styles.css\" \"utf8\"}}\r\n        </style>\r\n    </head>\r\n    <body>\r\n        <table name=\"Sales-Detail\">\r\n            <tbody class=\"head\">\r\n                <tr>\r\n                    <td></td>\r\n                    <td colspan=\"5\" class=\"title\">SALES DETAIL</td>\r\n                    <td></td>\r\n                </tr>\r\n                <tr>\r\n                    {{generateEmptyCell 7}}\r\n                </tr>\r\n                <tr>\r\n                    {{generateEmptyCell 1}}\r\n                    <td class=\"label content border-top border-left\">Customer</td>\r\n                    <td class=\"content border-top\">{{customer}}</td>\r\n                    {{generateEmptyCell 1 \"content border-top\"}}\r\n                    <td class=\"label content border-top\">Report Date</td>\r\n                    <td class=\"content border-top border-right t-right\" data-cell-type=\"date\" data-cell-format-str=\"dd-mm-yyyy\">{{nowStr}}</td>\r\n                    {{generateEmptyCell 1}}\r\n                </tr>\r\n                <tr>\r\n                    {{generateEmptyCell 1}}\r\n                    <td class=\"label content border-bottom border-left\">Month</td>\r\n                    <td class=\"content border-bottom\">{{month}}</td>\r\n                    {{generateEmptyCell 1 \"content border-bottom\"}}\r\n                    <td class=\"label content border-bottom\">Tax</td>\r\n                    <!-- enum = \"9\" percentage -->\r\n                    <td class=\"content border-bottom border-right t-right\" data-cell-type=\"number\" data-cell-format-enum=\"9\">{{taxPercentage}}</td>\r\n                    {{generateEmptyCell 1}}\r\n                </tr>\r\n                <tr>\r\n                    {{generateEmptyCell 7}}\r\n                </tr>\r\n            </tbody>\r\n            <tbody class=\"detail\">\r\n                <tr>\r\n                    <th class=\"t-center\">Date</th>\r\n                    <th class=\"t-left\">Product</th>\r\n                    <th class=\"t-left\">Category</th>\r\n                    <th class=\"t-right\">Unit Price</th>\r\n                    <th class=\"t-right\">Quantity</th>\r\n                    <th class=\"t-right\">Discount</th>\r\n                    <th class=\"t-right\">Amount</th>\r\n                </tr>\r\n                {{#each detail}}\r\n                    <tr class=\"{{oddClassName @index}}\">\r\n                        <td class=\"t-center\" data-cell-type=\"date\" data-cell-format-str=\"dd-mm-yyyy\">{{date}}</td>\r\n                        <td>{{product}}</td>\r\n                        <td>{{category}}</td>\r\n                        <td class=\"t-right\" data-cell-type=\"number\">{{unitPrice}}</td>\r\n                        <td class=\"t-right\" data-cell-type=\"number\">{{quantity}}</td>\r\n                        <td class=\"t-right\" data-cell-type=\"number\" data-cell-format-enum=\"9\">{{discountPercentage}}</td>\r\n                        <td class=\"t-right\" data-cell-type=\"formula\">=(D{{getDetailRowIndex @index}}*E{{getDetailRowIndex @index}}) - (D{{getDetailRowIndex @index}}*E{{getDetailRowIndex @index}}*F{{getDetailRowIndex @index}})</td>\r\n                    </tr>\r\n                {{/each}}\r\n                <tr>\r\n                    {{generateEmptyCell 5}}\r\n                    <td class=\"label\">Total Net Amount $</td>\r\n                    <td class=\"t-right\" data-cell-type=\"formula\">=SUM(G{{getDetailRowIndex 0}}:G{{getDetailRowIndex (sum detail.length -1)}})</td>\r\n                </tr>\r\n                <tr>\r\n                    {{generateEmptyCell 5}}\r\n                    <td class=\"label\" data-cell-type=\"formula\" data-cell-format-enum=\"2\">=CONCATENATE(\"VAT (\", F4*100, \"%)\", \" $\")</td>\r\n                    <td class=\"t-right\" data-cell-type=\"formula\" data-cell-format-enum=\"2\">=G{{getDetailRowIndex detail.length}}*F4</td>\r\n                </tr>\r\n                <tr>\r\n                    {{generateEmptyCell 5}}\r\n                    <td class=\"label\">Total $</td>\r\n                    <td class=\"t-right\" data-cell-type=\"formula\" data-cell-format-enum=\"2\">=SUM(G{{getDetailRowIndex detail.length}}:GG{{getDetailRowIndex (sum detail.length 1)}})</td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    </body>\r\n</html>\r\n"},"property":"helpers","statusCode":400,"weak":true,"logged":true,"previousOperationId":"z0ul35jb0ru4iue","id":"dnhwiw8omumvhv4","stack":"Error: require of \"moment\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"moment\"] }\n  at sandboxRequire (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\requireSandbox.js:53:19)\n  at Object.require (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:89:30)\n  at eval (sandbox.js:1:165)\n  at async run (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\createSandbox.js:132:18)\n  at async WorkerReporter.runInSandbox [as _runInSandbox] (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\sandbox\\runInSandbox.js:195:14)\n  at async executeEngine (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:287:14)\n  at async engine.engine (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:115:14)\n  at async invokeRender (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:61:23)\n  at async WorkerReporter._render (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:142:7)\n  at async C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\reporter.js:224:19\n  at async processAndResponse (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\advanced-workers\\lib\\workerHandler.js:41:17)\nwrapped by:\nError: Error when evaluating engine handlebars for template /samples/Sales/sales-main\n(because) require of \"moment\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"moment\"] }\n  at module.exports (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\createError.js:10:13)\n  at WorkerReporter.createError (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\shared\\reporter.js:49:12)\n  at executeEngine (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:310:33)\n  at async engine.engine (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\executeEngine.js:115:14)\n  at async invokeRender (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:61:23)\n  at async WorkerReporter._render (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\render\\render.js:142:7)\n  at async C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\jsreport-core\\lib\\worker\\reporter.js:224:19\n  at async processAndResponse (C:\\Users\\franc\\OneDrive\\Escritorio\\Angula\\Dashboard\\node_modules\\@jsreport\\advanced-workers\\lib\\workerHandler.js:41:17)","message":"Error when evaluating engine handlebars for template /samples/Sales/sales-main\n(because) require of \"moment\" module has been blocked. To be able to require custom modules you need to add to configuration { \"trustUserCode\": true } or enable just specific module using { sandbox: { allowedModules\": [\"moment\"] }\n\n(sandbox.js line 1:165)\n\n> 1 | const moment = require('moment')\n    |                                 ^\n  2 | const rowOffset = 6\n  3 |\n  4 | function nowStr () {\n\n"}
